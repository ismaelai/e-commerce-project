[{"/home/ismaelai/development/e-commerce-project/client/src/App.js":"1","/home/ismaelai/development/e-commerce-project/client/src/index.js":"2","/home/ismaelai/development/e-commerce-project/client/src/pages/Home.js":"3","/home/ismaelai/development/e-commerce-project/client/src/pages/auth/Login.js":"4","/home/ismaelai/development/e-commerce-project/client/src/pages/auth/Register.js":"5","/home/ismaelai/development/e-commerce-project/client/src/components/nav/Header.js":"6","/home/ismaelai/development/e-commerce-project/client/src/firebase.js":"7","/home/ismaelai/development/e-commerce-project/client/src/serviceWorker.js":"8","/home/ismaelai/development/e-commerce-project/client/src/pages/auth/RegisterComplete.js":"9","/home/ismaelai/development/e-commerce-project/client/src/reducers/userReducer.js":"10","/home/ismaelai/development/e-commerce-project/client/src/reducers/index.js":"11","/home/ismaelai/development/e-commerce-project/client/src/pages/auth/ForgotPassword.js":"12","/home/ismaelai/development/e-commerce-project/client/src/functions/auth.js":"13","/home/ismaelai/development/e-commerce-project/client/src/pages/user/History.js":"14","/home/ismaelai/development/e-commerce-project/client/src/components/routes/UserRoute.js":"15","/home/ismaelai/development/e-commerce-project/client/src/components/routes/LoadingToRedirect.js":"16","/home/ismaelai/development/e-commerce-project/client/src/components/nav/UserNav.js":"17","/home/ismaelai/development/e-commerce-project/client/src/pages/user/Password.js":"18"},{"size":2257,"mtime":1609170280590,"results":"19","hashOfConfig":"20"},{"size":925,"mtime":1608381414130,"results":"21","hashOfConfig":"20"},{"size":135,"mtime":1606567413955,"results":"22","hashOfConfig":"20"},{"size":4372,"mtime":1608380909890,"results":"23","hashOfConfig":"20"},{"size":1641,"mtime":1608385425420,"results":"24","hashOfConfig":"20"},{"size":1827,"mtime":1607541641516,"results":"25","hashOfConfig":"20"},{"size":749,"mtime":1608385627650,"results":"26","hashOfConfig":"20"},{"size":5103,"mtime":1606936845300,"results":"27","hashOfConfig":"20"},{"size":2931,"mtime":1608413625040,"results":"28","hashOfConfig":"20"},{"size":224,"mtime":1607003385372,"results":"29","hashOfConfig":"20"},{"size":179,"mtime":1607002743672,"results":"30","hashOfConfig":"20"},{"size":1610,"mtime":1607774607470,"results":"31","hashOfConfig":"20"},{"size":533,"mtime":1608379989060,"results":"32","hashOfConfig":"20"},{"size":333,"mtime":1609169803280,"results":"33","hashOfConfig":"20"},{"size":428,"mtime":1608384053280,"results":"34","hashOfConfig":"20"},{"size":643,"mtime":1608384160360,"results":"35","hashOfConfig":"20"},{"size":554,"mtime":1609169927390,"results":"36","hashOfConfig":"20"},{"size":1670,"mtime":1609171726610,"results":"37","hashOfConfig":"20"},{"filePath":"38","messages":"39","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"l12xae",{"filePath":"40","messages":"41","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"42"},{"filePath":"43","messages":"44","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"45"},{"filePath":"46","messages":"47","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"48","usedDeprecatedRules":"42"},{"filePath":"49","messages":"50","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"51"},{"filePath":"52","messages":"53","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"55","messages":"56","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"57","messages":"58","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"59"},{"filePath":"60","messages":"61","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"62","usedDeprecatedRules":"63"},{"filePath":"64","messages":"65","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"66","messages":"67","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"42"},{"filePath":"68","messages":"69","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"70","messages":"71","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"63"},{"filePath":"72","messages":"73","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"74","messages":"75","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"76"},{"filePath":"77","messages":"78","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"79"},{"filePath":"80","messages":"81","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"82","messages":"83","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/home/ismaelai/development/e-commerce-project/client/src/App.js",["84"],"/home/ismaelai/development/e-commerce-project/client/src/index.js",[],["85","86"],"/home/ismaelai/development/e-commerce-project/client/src/pages/Home.js",[],["87","88"],"/home/ismaelai/development/e-commerce-project/client/src/pages/auth/Login.js",["89"],"import React, { useState, useEffect } from 'react';\nimport { auth, googleAuthProvider } from '../../firebase.js';\nimport { toast } from 'react-toastify';\n// import { Button } from 'antd';\nimport { MailOutlined, GoogleOutlined } from '@ant-design/icons';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { createOrUpdateUser } from '../../functions/auth';\n\nconst Login = ({ history }) => {\n  const [email, setEmail] = useState('ismamontiel@hotmail.com');\n  const [password, setPassword] = useState('iniciarsesion');\n  const [loading, setLoading] = useState(false);\n\n  const { user } = useSelector((state) => ({ ...state }));\n\n  useEffect(() => {\n    if (user && user.token) history.push('/');\n  }, [user]);\n\n  let dispatch = useDispatch();\n\n  const roleBasedRedirect = (res) => {\n    if (res.data.role === 'admin') {\n      history.push('/admin/dashboard');\n    } else {\n      history.push('/user/history');\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    // console.table(email, password);\n    try {\n      const result = await auth.signInWithEmailLinkAndPassword(email, password);\n      // console.log(result);\n      const { user } = result;\n      const idTokenResult = await user.getIdTokenResult();\n\n      createOrUpdateUser(idTokenResult.token)\n        .then((res) => {\n          dispatch({\n            type: 'LOGGED_IN_USER',\n            payload: {\n              name: res.data.name,\n              email: res.data.email,\n              token: idTokenResult.token,\n              role: res.data.role,\n              _id: res.data._id,\n            },\n          });\n          roleBasedRedirect(res);\n        })\n        .catch((err) => console.log(err));\n\n      // history.push('/');\n    } catch (error) {\n      console.log(error);\n      toast.error(error.message);\n      setLoading(false);\n    }\n  };\n\n  const googleLogin = async () => {\n    auth\n      .signInWithPopup(googleAuthProvider)\n      .then(async (result) => {\n        const { user } = result;\n        const idTokenResult = await user.getIdTokenResult();\n        createOrUpdateUser(idTokenResult.token)\n          .then((res) => {\n            dispatch({\n              type: 'LOGGED_IN_USER',\n              payload: {\n                name: res.data.name,\n                email: res.data.email,\n                token: idTokenResult.token,\n                role: res.data.role,\n                _id: res.data._id,\n              },\n            });\n            roleBasedRedirect(res);\n          })\n          .catch();\n        // history.push('/');\n      })\n      .catch((err) => {\n        console.log(err);\n        toast.error(err.message);\n      });\n  };\n\n  const loginForm = () => (\n    <form onSubmit={handleSubmit}>\n      <div className=\"form-group\">\n        <input\n          type=\"email\"\n          className=\"form-control\"\n          value={email}\n          onChange={(e) => setEmail(e.target.value)}\n          placeholder=\"Your email\"\n          autoFocus\n        />\n      </div>\n\n      <div className=\"form-group\">\n        <input\n          type=\"password\"\n          className=\"form-control\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n          placeholder=\"Your password\"\n        />\n      </div>\n\n      <br></br>\n      <button\n        onClick={handleSubmit}\n        type=\"primary\"\n        className=\"mb-3\"\n        block\n        shape=\"round\"\n        icon={<MailOutlined />}\n        size=\"large\"\n        disabled={!email || password.length < 6}\n      >\n        Login with Email/Password\n      </button>\n    </form>\n  );\n\n  return (\n    <div className=\"container p-5\">\n      <div className=\"row\">\n        <div className=\"col-md-6 offset-md-3\">\n          {loading ? (\n            <h4 className=\"text-danger\">Loading...</h4>\n          ) : (\n            <h4>Login</h4>\n          )}\n\n          {loginForm()}\n\n          <button\n            onClick={googleLogin}\n            type=\"danger\"\n            className=\"mb-3\"\n            block\n            shape=\"round\"\n            icon={<GoogleOutlined />}\n            size=\"large\"\n          >\n            Login with Google\n          </button>\n\n          <Link to=\"/forgot/password\" className=\"float-right text-danger\">\n            Forgot Password\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default Login;\n","/home/ismaelai/development/e-commerce-project/client/src/pages/auth/Register.js",["90"],"import React, { useState, useEffect } from 'react';\nimport { auth } from '../../firebase';\nimport { useSelector } from 'react-redux';\nimport { toast, ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nconst Register = ({ history }) => {\n  const [email, setEmail] = useState('');\n\n  const { user } = useSelector((state) => ({ ...state }));\n\n  useEffect(() => {\n    if (user && user.token) history.push('/');\n  }, [user]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    // console.log(\"ENV --->\", process.env.REACT_APP_REGISTER_REDIRECT_URL);\n    const config = {\n      url: 'http://localhost:3000/register-complete',\n      handleCodeInApp: true,\n    };\n\n    await auth.sendSignInLinkToEmail(email, config);\n    toast.success(\n      `Email is sent to ${email}. Click the link to complete your registration.`,\n    );\n    // save user email in local storage\n    window.localStorage.setItem('emailForRegistration', email);\n    // clear state\n    setEmail('');\n  };\n\n  const registerFrom = () => (\n    <form onSubmit={handleSubmit}>\n      <input\n        type=\"email\"\n        className=\"form-control\"\n        value={email}\n        onChange={(e) => setEmail(e.target.value)}\n        autoFocus\n      />\n\n      <button type=\"submit\" className=\"btn btn-raised\">\n        Register\n      </button>\n    </form>\n  );\n\n  return (\n    <div className=\"container p-5\">\n      <div className=\"row\">\n        <div className=\"col-md-6 offset-md-3\">\n          <h4> Register </h4>\n          <ToastContainer />\n          {registerFrom()}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Register;\n","/home/ismaelai/development/e-commerce-project/client/src/components/nav/Header.js",[],["91","92"],"/home/ismaelai/development/e-commerce-project/client/src/firebase.js",[],"/home/ismaelai/development/e-commerce-project/client/src/serviceWorker.js",[],["93","94"],"/home/ismaelai/development/e-commerce-project/client/src/pages/auth/RegisterComplete.js",["95"],"import React, { useState, useEffect } from 'react';\nimport { auth } from '../../firebase';\nimport { toast } from 'react-toastify';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { createOrUpdateUser } from '../../functions/auth';\n\nconst RegisterComplete = ({ history }) => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n\n  const { user } = useSelector((state) => ({ ...state }));\n  let dispatch = useDispatch();\n\n  useEffect(() => {\n    setEmail(window.localStorage.getItem('emailForRegistration'));\n    // console.log(window.location.href);\n    // console.log(window.localStorage.getItem(\"emailForRegistration\"));\n  }, []);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    // validation\n    if (!email || !password) {\n      toast.error('Email and password is required');\n      return;\n    }\n\n    if (password.length < 6) {\n      toast.error('Password must be at least 6 characters long');\n      return;\n    }\n\n    try {\n      const result = await auth.signInWithEmailLink(\n        email,\n        window.location.href,\n      );\n      //   console.log(\"RESULT\", result);\n      if (result.user.emailVerified) {\n        // remove user email fom local storage\n        window.localStorage.removeItem('emailForRegistration');\n        // get user id token\n        let user = auth.currentUser;\n        await user.updatePassword(password);\n        const idTokenResult = await user.getIdTokenResult();\n        // redux store\n        console.log('user', user, 'idTokenResult', idTokenResult);\n\n        createOrUpdateUser(idTokenResult.token)\n          .then((res) => {\n            dispatch({\n              type: 'LOGGED_IN_USER',\n              payload: {\n                name: res.data.name,\n                email: res.data.email,\n                token: idTokenResult.token,\n                role: res.data.role,\n                _id: res.data._id,\n              },\n            });\n          })\n          .catch((err) => console.log(err));\n\n        // redirect\n        history.push('/');\n      }\n    } catch (error) {\n      console.log(error);\n      toast.error(error.message);\n    }\n  };\n\n  const completeRegistrationForm = () => (\n    <form onSubmit={handleSubmit}>\n      <input type=\"email\" className=\"form-control\" value={email} disabled />\n\n      <input\n        type=\"password\"\n        className=\"form-control\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n        placeholder=\"Password\"\n        autoFocus\n      />\n      <br />\n      <button type=\"submit\" className=\"btn btn-raised\">\n        Complete Registration\n      </button>\n    </form>\n  );\n\n  return (\n    <div className=\"container p-5\">\n      <div className=\"row\">\n        <div className=\"col-md-6 offset-md-3\">\n          <h4>Register Complete</h4>\n          {completeRegistrationForm()}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default RegisterComplete;\n",["96","97"],"/home/ismaelai/development/e-commerce-project/client/src/reducers/userReducer.js",[],"/home/ismaelai/development/e-commerce-project/client/src/reducers/index.js",[],"/home/ismaelai/development/e-commerce-project/client/src/pages/auth/ForgotPassword.js",["98","99"],"/home/ismaelai/development/e-commerce-project/client/src/functions/auth.js",[],"/home/ismaelai/development/e-commerce-project/client/src/pages/user/History.js",[],"/home/ismaelai/development/e-commerce-project/client/src/components/routes/UserRoute.js",["100"],"import React from 'react';\nimport { Route, Link } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport LoadingToRedirect from './LoadingToRedirect';\n\nconst UserRoute = ({ children, ...rest }) => {\n  const { user } = useSelector((state) => ({ ...state }));\n\n  return user && user.token ? (\n    <Route {...rest} render={() => children} />\n  ) : (\n    <LoadingToRedirect />\n  );\n};\n\nexport default UserRoute;\n","/home/ismaelai/development/e-commerce-project/client/src/components/routes/LoadingToRedirect.js",["101"],"import React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\n\nconst LoadingToRedirect = () => {\n  const [count, setcount] = useState(5);\n  let history = useHistory();\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setcount((currentCount) => --currentCount);\n    }, 1000);\n    // redirect once count is equal to 0\n    count === 0 && history.push('/');\n    //cleanup\n    return () => clearInterval(interval);\n  }, [count]);\n\n  return (\n    <div className=\"container p-5 text-center\">\n      <p>Redirecting you in {count} seconds</p>\n    </div>\n  );\n};\n\nexport default LoadingToRedirect;\n","/home/ismaelai/development/e-commerce-project/client/src/components/nav/UserNav.js",[],"/home/ismaelai/development/e-commerce-project/client/src/pages/user/Password.js",[],{"ruleId":"102","severity":1,"message":"103","line":50,"column":6,"nodeType":"104","endLine":50,"endColumn":8,"suggestions":"105"},{"ruleId":"106","replacedBy":"107"},{"ruleId":"108","replacedBy":"109"},{"ruleId":"106","replacedBy":"110"},{"ruleId":"108","replacedBy":"111"},{"ruleId":"102","severity":1,"message":"112","line":19,"column":6,"nodeType":"104","endLine":19,"endColumn":12,"suggestions":"113"},{"ruleId":"102","severity":1,"message":"112","line":14,"column":6,"nodeType":"104","endLine":14,"endColumn":12,"suggestions":"114"},{"ruleId":"106","replacedBy":"115"},{"ruleId":"108","replacedBy":"116"},{"ruleId":"106","replacedBy":"117"},{"ruleId":"108","replacedBy":"118"},{"ruleId":"119","severity":1,"message":"120","line":11,"column":11,"nodeType":"121","messageId":"122","endLine":11,"endColumn":15},{"ruleId":"106","replacedBy":"123"},{"ruleId":"108","replacedBy":"124"},{"ruleId":"119","severity":1,"message":"125","line":2,"column":16,"nodeType":"121","messageId":"122","endLine":2,"endColumn":34},{"ruleId":"102","severity":1,"message":"112","line":14,"column":6,"nodeType":"104","endLine":14,"endColumn":12,"suggestions":"126"},{"ruleId":"119","severity":1,"message":"127","line":2,"column":17,"nodeType":"121","messageId":"122","endLine":2,"endColumn":21},{"ruleId":"102","severity":1,"message":"112","line":16,"column":6,"nodeType":"104","endLine":16,"endColumn":13,"suggestions":"128"},"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'dispatch'. Either include it or remove the dependency array.","ArrayExpression",["129"],"no-native-reassign",["130"],"no-negated-in-lhs",["131"],["130"],["131"],"React Hook useEffect has a missing dependency: 'history'. Either include it or remove the dependency array.",["132"],["133"],["130"],["131"],["130"],["131"],"no-unused-vars","'user' is assigned a value but never used.","Identifier","unusedVar",["130"],["131"],"'googleAuthProvider' is defined but never used.",["134"],"'Link' is defined but never used.",["135"],{"desc":"136","fix":"137"},"no-global-assign","no-unsafe-negation",{"desc":"138","fix":"139"},{"desc":"138","fix":"140"},{"desc":"138","fix":"141"},{"desc":"142","fix":"143"},"Update the dependencies array to be: [dispatch]",{"range":"144","text":"145"},"Update the dependencies array to be: [history, user]",{"range":"146","text":"147"},{"range":"148","text":"147"},{"range":"149","text":"147"},"Update the dependencies array to be: [count, history]",{"range":"150","text":"151"},[1590,1592],"[dispatch]",[752,758],"[history, user]",[450,456],[464,470],[471,478],"[count, history]"]